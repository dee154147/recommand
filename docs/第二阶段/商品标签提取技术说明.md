# 商品标签提取技术说明

## 概述

商品标签提取是推荐系统的核心功能之一，通过jieba中文分词技术从商品标题中自动提取有意义的标签，为后续的推荐算法提供特征基础。

## 技术架构

### 1. 核心组件

- **jieba分词器**: 中文分词和词性标注
- **停用词过滤**: 移除无意义的词汇
- **词性过滤**: 只保留有意义的词性
- **长度过滤**: 过滤过短的词汇
- **数字过滤**: 移除纯数字

### 2. 处理流程

```
商品标题 → 文本清洗 → jieba分词 → 词性标注 → 多重过滤 → 标签提取 → 数据库存储
```

## 详细实现

### 1. 文本预处理

```python
def clean_text(self, text: str) -> str:
    """清洗文本"""
    # 移除HTML标签
    text = re.sub(r'<[^>]+>', '', text)
    
    # 移除特殊字符，保留中文、英文、数字、空格
    text = re.sub(r'[^\u4e00-\u9fa5a-zA-Z0-9\s]', '', text)
    
    # 移除多余空格
    text = re.sub(r'\s+', ' ', text)
    
    return text.strip()
```

### 2. jieba分词

使用jieba的`posseg`模块进行词性标注分词：

```python
import jieba.posseg as pseg

def segment_text(self, text: str) -> List[str]:
    """对文本进行分词"""
    words = pseg.cut(text)
    meaningful_words = []
    for word, flag in words:
        if self._is_meaningful_word(word, flag):
            meaningful_words.append(word)
    return meaningful_words
```

### 3. 多重过滤机制

#### 3.1 长度过滤
- 过滤长度小于2的词汇
- 避免单字符噪音

#### 3.2 停用词过滤
包含以下类别的停用词：
- **常用停用词**: 的、了、在、是、我、有、和、就、不...
- **商品相关**: 元、块、钱、包、件、个、只、双、条...
- **营销词汇**: 特价、优惠、折扣、免费、包邮、正品...
- **操作词汇**: 分享、收藏、加购、下单、支付...
- **描述词汇**: 说明、介绍、详情、规格、参数...
- **技术参数**: 温度、湿度、压力、电压、电流...
- **性能词汇**: 防水性、防火性、防腐性...
- **环保词汇**: 环保性、可回收性、可降解性...
- **生产信息**: 生产日期、生产批号、生产厂家...
- **平台名称**: 阿里巴巴、淘宝、天猫、京东...
- **支付方式**: 支付宝、微信支付、银联...

#### 3.3 词性过滤
只保留有意义的词性：
- `n`: 名词
- `nr`: 人名
- `ns`: 地名
- `nt`: 机构团体
- `nw`: 作品名
- `nz`: 其他专名
- `v`: 动词
- `vn`: 名动词
- `a`: 形容词
- `ad`: 副形词
- `an`: 名形词
- `eng`: 英文

#### 3.4 数字过滤
- 移除纯数字词汇
- 保留包含字母的数字（如型号）

### 4. 标签权重计算

每个标签的权重默认为1.0，可以根据以下因素调整：
- 词频统计
- 位置权重（标题开头权重更高）
- 词性权重（名词权重高于形容词）

## 实际效果展示

### 示例1: 女装商品
**原始标题**: "经典故事 女装 秋装 热卖 时尚 简约 纯色 棉质 褶皱短裙 半身裙 A 字 群 Q 790"

**提取标签**: 
- 经典 (n)
- 故事 (n) 
- 女装 (n)
- 秋装 (n)
- 热卖 (v)
- 时尚 (n)
- 纯色 (n)
- 棉质 (n)
- 褶皱 (n)
- 短裙 (n)
- 半身裙 (n)

### 示例2: 数码产品
**原始标题**: "iPhone 15 Pro Max 256GB 深空黑色"

**提取标签**:
- iPhone (eng)
- Pro (eng)
- Max (eng)
- GB (eng)
- 黑色 (n)

### 示例3: 运动鞋
**原始标题**: "Nike Air Max 270 运动鞋 男款 白色"

**提取标签**:
- Nike (eng)
- Air (eng)
- Max (eng)
- 运动鞋 (n)
- 男款 (n)
- 白色 (n)

## 数据库存储

### 表结构

```sql
-- 商品标签表
CREATE TABLE product_tags (
    id INTEGER PRIMARY KEY,
    product_id INTEGER NOT NULL,
    tag VARCHAR(100) NOT NULL,
    weight DECIMAL(5,4) DEFAULT 1.0,
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (product_id) REFERENCES products(id)
);

-- 标签向量表
CREATE TABLE tag_vectors (
    id INTEGER PRIMARY KEY,
    tag VARCHAR(100) UNIQUE NOT NULL,
    vector TEXT,  -- JSON格式存储向量
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP
);
```

### 存储示例

```sql
-- 商品标签
INSERT INTO product_tags (product_id, tag, weight) VALUES
(1, '女装', 1.0),
(1, '秋装', 1.0),
(1, '时尚', 1.0),
(1, '棉质', 1.0),
(1, '短裙', 1.0);
```

## 性能统计

### 处理结果
- **总商品数**: 49,190个
- **总标签数**: 387,662个
- **平均每商品标签数**: 7.9个
- **成功率**: 98.3%

### 热门标签TOP10
1. 正品 (11,495次)
2. 新款 (8,110次)
3. 韩版 (5,646次)
4. 时尚 (4,774次)
5. 包邮 (4,402次)
6. 男士 (3,929次)
7. 休闲 (3,716次)
8. 正版 (2,745次)
9. 女士 (2,545次)
10. 专柜 (2,540次)

## 技术优势

### 1. 准确性
- 基于jieba成熟的中文分词技术
- 多重过滤机制确保标签质量
- 词性标注提高语义准确性

### 2. 效率
- 批量处理支持大规模数据
- 优化的停用词表减少噪音
- 数据库索引提高查询效率

### 3. 可扩展性
- 支持自定义停用词表
- 支持用户词典扩展
- 支持权重调整算法

### 4. 一致性
- 标准化的处理流程
- 统一的存储格式
- 完整的错误处理机制

## 应用场景

### 1. 推荐算法
- 基于标签相似度的商品推荐
- 用户兴趣标签匹配
- 协同过滤算法特征

### 2. 搜索功能
- 语义搜索关键词匹配
- 标签权重排序
- 模糊匹配支持

### 3. 数据分析
- 商品分类统计
- 热门标签趋势分析
- 用户行为分析

## 未来优化方向

### 1. 算法优化
- 引入TF-IDF权重计算
- 支持N-gram特征提取
- 集成深度学习模型

### 2. 性能优化
- 并行处理支持
- 缓存机制优化
- 增量更新支持

### 3. 功能扩展
- 支持多语言标签提取
- 情感分析集成
- 实体识别支持

---

*本文档详细说明了商品标签提取的技术实现和应用效果，为推荐系统的核心功能提供了坚实的技术基础。*
