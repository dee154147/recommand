# 第一阶段系统配置文件清单

## 文档信息
- **创建时间**: 2024年12月20日
- **用途**: 系统配置文件的完整清单，便于后续开发环境搭建

---

## 1. 后端配置文件

### 1.1 Python依赖文件
**文件路径**: `backend/requirements.txt`
```txt
Flask==2.3.3
Flask-SQLAlchemy==3.0.5
Flask-Migrate==4.0.5
Flask-CORS==4.0.0
psycopg2-binary==2.9.7
redis==4.6.0
jieba==0.42.1
numpy==1.24.3
python-dotenv==1.0.0
gunicorn==21.2.0
```

### 1.2 应用配置文件
**文件路径**: `backend/app/config.py`
- 开发环境配置
- 生产环境配置
- 测试环境配置
- 数据库连接配置
- Redis缓存配置

### 1.3 应用工厂文件
**文件路径**: `backend/app/__init__.py`
- Flask应用初始化
- 蓝图注册
- 数据库初始化
- 错误处理配置

### 1.4 启动脚本
**文件路径**: `backend/run.py`
```python
from app import create_app, db

app = create_app('development')

if __name__ == '__main__':
    with app.app_context():
        db.create_all()
    app.run(debug=True, host='0.0.0.0', port=5000)
```

---

## 2. 前端配置文件

### 2.1 依赖配置文件
**文件路径**: `frontend/package.json`
```json
{
  "name": "recommendation-frontend",
  "version": "1.0.0",
  "private": true,
  "scripts": {
    "dev": "vite",
    "build": "vite build",
    "preview": "vite preview"
  },
  "dependencies": {
    "vue": "^3.3.4",
    "vue-router": "^4.2.4",
    "pinia": "^2.1.6",
    "element-plus": "^2.3.8",
    "axios": "^1.4.0",
    "@element-plus/icons-vue": "^2.1.0"
  },
  "devDependencies": {
    "@vitejs/plugin-vue": "^4.2.3",
    "vite": "^4.4.5",
    "sass": "^1.64.1",
    "eslint": "^8.45.0",
    "eslint-plugin-vue": "^9.15.1"
  }
}
```

### 2.2 构建工具配置
**文件路径**: `frontend/vite.config.js`
```javascript
import { defineConfig } from 'vite'
import vue from '@vitejs/plugin-vue'
import { resolve } from 'path'

export default defineConfig({
  plugins: [vue()],
  resolve: {
    alias: {
      '@': resolve(__dirname, 'src')
    }
  },
  server: {
    port: 3001,
    proxy: {
      '/api': {
        target: 'http://localhost:5000',
        changeOrigin: true,
        rewrite: (path) => path.replace(/^\/api/, '')
      }
    }
  }
})
```

### 2.3 路由配置
**文件路径**: `frontend/src/router/index.js`
```javascript
import { createRouter, createWebHistory } from 'vue-router'
import Home from '@/views/Home.vue'
import ProductSearch from '@/views/ProductSearch.vue'
import ProductManage from '@/views/ProductManage.vue'
import UserDashboard from '@/views/UserDashboard.vue'

const routes = [
  { path: '/', name: 'Home', component: Home },
  { path: '/products', name: 'ProductSearch', component: ProductSearch },
  { path: '/manage', name: 'ProductManage', component: ProductManage },
  { path: '/dashboard', name: 'UserDashboard', component: UserDashboard }
]

const router = createRouter({
  history: createWebHistory(),
  routes
})

export default router
```

### 2.4 状态管理配置
**文件路径**: `frontend/src/store/index.js`
```javascript
import { createPinia } from 'pinia'

const pinia = createPinia()

export default pinia
```

---

## 3. 数据库配置文件

### 3.1 数据库模型配置
**文件路径**: `backend/app/models/__init__.py`
```python
from .product import Product
from .category import Category
from .user import User
from .interaction import UserInteraction
from .recommendation import RecommendationCache

__all__ = [
    'Product', 'Category', 'User', 
    'UserInteraction', 'RecommendationCache'
]
```

### 3.2 数据库连接配置
**配置项**: 在 `backend/app/config.py` 中
```python
# 开发环境
SQLALCHEMY_DATABASE_URI = 'postgresql://username:password@localhost/recommendation_dev'

# 生产环境
SQLALCHEMY_DATABASE_URI = 'postgresql://username:password@localhost/recommendation_prod'
```

---

## 4. Docker配置文件

### 4.1 Docker编排文件
**文件路径**: `config/docker-compose.yml`
```yaml
version: '3.8'

services:
  postgres:
    image: postgres:15
    environment:
      POSTGRES_DB: recommendation_db
      POSTGRES_USER: username
      POSTGRES_PASSWORD: password
    ports:
      - "5432:5432"
    volumes:
      - postgres_data:/var/lib/postgresql/data

  redis:
    image: redis:7-alpine
    ports:
      - "6379:6379"
    volumes:
      - redis_data:/data

  backend:
    build:
      context: ../backend
      dockerfile: ../config/Dockerfile.backend
    ports:
      - "5000:5000"
    depends_on:
      - postgres
      - redis
    environment:
      - DATABASE_URL=postgresql://username:password@postgres:5432/recommendation_db
      - REDIS_URL=redis://redis:6379/0

  frontend:
    build:
      context: ../frontend
      dockerfile: ../config/Dockerfile.frontend
    ports:
      - "3001:3001"
    depends_on:
      - backend

volumes:
  postgres_data:
  redis_data:
```

### 4.2 后端Dockerfile
**文件路径**: `config/Dockerfile.backend`
```dockerfile
FROM python:3.9-slim

WORKDIR /app

COPY requirements.txt .
RUN pip install -r requirements.txt

COPY . .

EXPOSE 5000

CMD ["gunicorn", "--bind", "0.0.0.0:5000", "run:app"]
```

### 4.3 前端Dockerfile
**文件路径**: `config/Dockerfile.frontend`
```dockerfile
FROM node:18-alpine

WORKDIR /app

COPY package*.json ./
RUN npm install

COPY . .

EXPOSE 3001

CMD ["npm", "run", "dev"]
```

---

## 5. 环境配置文件

### 5.1 环境变量示例
**文件路径**: `config/.env.example`
```env
# 数据库配置
DATABASE_URL=postgresql://username:password@localhost/recommendation_db
DEV_DATABASE_URL=postgresql://username:password@localhost/recommendation_dev
TEST_DATABASE_URL=sqlite:///:memory:

# Redis配置
REDIS_URL=redis://localhost:6379/0

# Flask配置
SECRET_KEY=your-secret-key-here
FLASK_ENV=development
FLASK_DEBUG=True

# 应用配置
APP_HOST=0.0.0.0
APP_PORT=5000
```

### 5.2 Nginx配置
**文件路径**: `config/nginx.conf`
```nginx
server {
    listen 80;
    server_name localhost;

    location / {
        proxy_pass http://frontend:3001;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
    }

    location /api {
        proxy_pass http://backend:5000;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
    }
}
```

---

## 6. 脚本文件

### 6.1 启动脚本
**文件路径**: `scripts/start.sh`
```bash
#!/bin/bash

echo "启动推荐系统..."

# 启动数据库服务
echo "启动PostgreSQL..."
docker-compose -f config/docker-compose.yml up -d postgres

# 启动Redis服务
echo "启动Redis..."
docker-compose -f config/docker-compose.yml up -d redis

# 等待数据库启动
sleep 5

# 启动后端服务
echo "启动后端服务..."
cd backend
python run.py &
BACKEND_PID=$!

# 启动前端服务
echo "启动前端服务..."
cd ../frontend
npm run dev &
FRONTEND_PID=$!

echo "系统启动完成!"
echo "前端地址: http://localhost:3001"
echo "后端地址: http://localhost:5000"
echo "数据库: localhost:5432"
echo "Redis: localhost:6379"

# 保存进程ID
echo $BACKEND_PID > ../scripts/backend.pid
echo $FRONTEND_PID > ../scripts/frontend.pid
```

### 6.2 停止脚本
**文件路径**: `scripts/stop.sh`
```bash
#!/bin/bash

echo "停止推荐系统..."

# 停止后端服务
if [ -f scripts/backend.pid ]; then
    BACKEND_PID=$(cat scripts/backend.pid)
    kill $BACKEND_PID
    rm scripts/backend.pid
    echo "后端服务已停止"
fi

# 停止前端服务
if [ -f scripts/frontend.pid ]; then
    FRONTEND_PID=$(cat scripts/frontend.pid)
    kill $FRONTEND_PID
    rm scripts/frontend.pid
    echo "前端服务已停止"
fi

# 停止Docker服务
docker-compose -f config/docker-compose.yml down

echo "系统已完全停止"
```

---

## 7. 数据文件

### 7.1 商品数据
**文件路径**: `data/product.txt`
- 包含商品基础信息
- 用于系统测试和演示

### 7.2 商品类型数据
**文件路径**: `data/productType.json`
- 商品分类信息
- JSON格式存储

### 7.3 模型文件
**文件路径**: `model/`
- `Tencent_AILab_ChineseEmbedding.bin` - 中文词向量模型
- `Tencent_AILab_ChineseEmbedding.bin.vectors.npy` - 向量数据

---

## 8. 文档文件

### 8.1 项目信息
**文件路径**: `docs/项目信息.md`
- 项目基本信息和目标

### 8.2 架构设计文档
**文件路径**: `docs/第一阶段/系统架构设计文档.md`
- 系统整体架构设计
- 技术选型说明

### 8.3 开发总结
**文件路径**: `docs/第一阶段/第一阶段开发总结.md`
- 第一阶段开发完成情况
- 功能特性总结

### 8.4 变更记录
**文件路径**: `docs/change/`
- 所有开发变更的详细记录
- 按时间戳命名的变更文档

### 8.5 原型文件
**文件路径**: `docs/第一阶段/prototype/`
- `index.html` - 原型页面
- `原型设计说明.md` - 原型设计文档

---

## 9. 配置文件使用说明

### 9.1 开发环境搭建
1. **克隆项目**: `git clone <repository-url>`
2. **安装后端依赖**: `cd backend && pip install -r requirements.txt`
3. **安装前端依赖**: `cd frontend && npm install`
4. **配置环境变量**: 复制 `config/.env.example` 为 `.env`
5. **启动数据库**: `docker-compose -f config/docker-compose.yml up -d postgres redis`
6. **启动服务**: 运行 `./scripts/start.sh`

### 9.2 生产环境部署
1. **构建镜像**: `docker-compose -f config/docker-compose.yml build`
2. **启动服务**: `docker-compose -f config/docker-compose.yml up -d`
3. **配置Nginx**: 使用 `config/nginx.conf` 配置反向代理

### 9.3 配置文件修改
- **数据库配置**: 修改 `backend/app/config.py`
- **前端配置**: 修改 `frontend/vite.config.js`
- **Docker配置**: 修改 `config/docker-compose.yml`
- **环境变量**: 修改 `.env` 文件

---

## 10. 配置文件检查清单

### 10.1 必需配置文件
- [ ] `backend/requirements.txt` - Python依赖
- [ ] `backend/app/config.py` - 应用配置
- [ ] `frontend/package.json` - 前端依赖
- [ ] `frontend/vite.config.js` - 构建配置
- [ ] `config/docker-compose.yml` - Docker编排
- [ ] `config/.env.example` - 环境变量示例

### 10.2 可选配置文件
- [ ] `config/nginx.conf` - Nginx配置
- [ ] `scripts/start.sh` - 启动脚本
- [ ] `scripts/stop.sh` - 停止脚本
- [ ] `.gitignore` - Git忽略文件
- [ ] `README.md` - 项目说明

### 10.3 数据文件
- [ ] `data/product.txt` - 商品数据
- [ ] `data/productType.json` - 分类数据
- [ ] `model/` - 模型文件目录

---

## 11. 配置文件维护

### 11.1 版本控制
- 所有配置文件都应纳入版本控制
- 敏感信息使用环境变量或 `.env` 文件
- 定期更新依赖版本

### 11.2 安全考虑
- 生产环境使用强密码
- 定期更新依赖包
- 使用HTTPS证书
- 配置防火墙规则

### 11.3 性能优化
- 数据库连接池配置
- Redis缓存配置
- 静态文件压缩
- CDN配置

---

## 12. 故障排除

### 12.1 常见问题
1. **端口冲突**: 检查端口占用情况
2. **依赖安装失败**: 检查Python/Node版本
3. **数据库连接失败**: 检查数据库服务状态
4. **前端代理失败**: 检查Vite代理配置

### 12.2 日志查看
- **后端日志**: Flask应用日志
- **前端日志**: 浏览器开发者工具
- **数据库日志**: PostgreSQL日志
- **Docker日志**: `docker-compose logs`

---

*本清单包含了第一阶段系统的所有配置文件，为后续开发环境搭建和系统部署提供完整参考。*
